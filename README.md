# 🚍 CalmWay

## 혼잡도 기반 대중교통 경로 추천 서비스

CalmWay는 기존 최단 시간·최소 환승 중심의 길찾기를 넘어,
실시간·예측 혼잡도를 고려한 대중교통 경로를 추천하는 서비스입니다.
지하철과 버스의 시간대별 혼잡도를 머신러닝으로 예측하고,
경로 전체의 혼잡도를 종합 점수로 제공하여 보다 쾌적한 이동을 돕습니다.

### ✨ 주요 기능

- TMAP 대중교통 API 연동

- 경로 탐색(길찾기) 기능 및 필터링

- 도보 / 지하철 / 버스 혼합 경로 파싱

- 지하철 혼잡도 예측

- 버스 혼잡도 예측

- 지하철 + 버스 구간을 통합한 종합 혼잡도 점수 산출

- 시각화용 경로 지도 제공

- 분석 결과 그래프 제공


### ⚠️ 정책
경로 내 단 하나라도 혼잡도 계산이 불가능한 구간이 있으면,
해당 경로의 혼잡도 점수는 null로 반환합니다.

### 🗂 프로젝트 구조
```
KW-CalmWay/
├─ app/
│  └─ main.py                       # FastAPI 엔트리포인트
├─ api/
│  ├─ poi.py                        # TMAP api 엔드포인트
│  └─ routes.py                     # TMAP 대중교통 api 엔드포인트
├─ parsers/
│  ├─ tmap_parser.py                # TMAP 경로 파싱
│  └─ bus_id_parser.py              # 버스 정류장명 → ARS ID 매핑
├─ services/
│  ├─ model_evaluation_service.py   # 모델 평가 스크립트
│  ├─ subway_service.py             # 지하철 혼잡도 예측 (RF)
│  ├─ bus_service.py                # 버스 혼잡도 예측 (RF)
│  └─ intergrate_service.py         # 지하철+버스 혼합 경로 예측
├─ static/                          # 정적 파일
│  ├─ data/
│  │  ├─ subway_data/               # 지하철 승하차 / 혼잡도 공공데이터
│  │  └─ bus_data/                  # 버스 승하차 / 배차 공공데이터
│  └─ images/
│     ├─ maps/                      # 호선별 혼잡도 지도 그래프
│     └─ topGraph/                  # 호선별 상위 10개 역 혼잡도 예측 그래프
├─ templates/                       # html 파일
└─ README.md
```

### ⚠️ 제한 사항

- 일부 마을버스 또는 심야버스와 정류장 노선 포함 경로는 정류장 ARS 매칭 또는 학습 데이터 부족으로 혼잡도 계산 불가

- 실시간 데이터가 아닌 통계 기반 예측이므로 실제 상황과 차이가 있을 수 있음

### 🚀 실행 방법
```
pip install -r requirements.txt
uvicorn app.main:app --reload
```

- 환경 변수 설정 (.env 파일 생성)

    프로젝트 루트 디렉토리에 .env 파일을 생성하고,
    TMAP에서 발급받은 API 키를 아래와 같이 입력합니다.
    ```
    TMAP_APP_KEY=발급받은_TMAP_API_KEY
    ```
- 접속: http://127.0.0.1:8000/

### 👥 팀 & 프로젝트
"광운대학교 파이썬 SW 활용 경진대회 참가작"

- 팀명: 샛별이집사

- 주제: 시간대별 혼잡도 예측을 활용한 AI 대중교통 경로 추천 서비스

- 활용 데이터: 지하철 혼잡도 정보,  지하철 역 위치 좌표, 지하철 승하차 순위, 버스 노선별, 정류장별, 시간대별 승하차 인원 정보, 버스 배차간격, TMAP API 및 대중교통 API
